# 🔐 登录问题排查

## 📋 当前状态

### 问题描述
用户报告无法登录系统，出现"未登录"错误。

### 已完成的修复
1. ✅ 修复了 `cloudDataService.ts` 中的 `getArticlesFromCloud` 函数错误
2. ✅ 统一了API配置中的URL设置
3. ✅ 添加了认证路由的调试日志
4. ✅ 重置了用户密码

## 🔑 用户账号和密码

### 系统用户账号
- **管理员**: `admin` / `admin123`
- **维护人员**: `maintenance` / `123456`
- **普通用户**: `user` / `user123`

### 测试账号
- **测试管理员**: `testadmin` / `test123`

## 🌐 访问地址
- **主网站**: http://116.62.65.246:3000/
- **API服务器**: http://116.62.65.246/api/

## 🔧 技术问题

### 1. 密码哈希问题
- 数据库中的密码哈希被截断
- 需要重新生成正确的密码哈希

### 2. 认证流程
- 前端发送登录请求到 `/api/auth/login`
- 后端验证用户名和密码
- 生成JWT令牌并返回

### 3. 调试信息
已添加详细的调试日志到认证路由：
- 登录尝试信息
- 用户查询结果
- 密码验证结果

## 🚨 当前问题

### 主要问题
1. **密码验证失败**: 数据库中的密码哈希不完整
2. **API连接**: 前端无法正确连接到后端API
3. **错误处理**: 需要更好的错误提示

### 解决方案
1. 重新生成完整的密码哈希
2. 确保API服务器正常运行
3. 检查网络连接和防火墙设置

## 📝 测试步骤

### 1. 检查服务器状态
```bash
ssh root@116.62.65.246 "ps aux | grep node"
```

### 2. 测试API连接
```bash
curl -X POST http://116.62.65.246/api/auth/login \
  -H 'Content-Type: application/json' \
  -d '{"username":"admin","password":"admin123"}'
```

### 3. 检查数据库
```bash
ssh root@116.62.65.246 "mysql -u root -p123456 -e 'USE learning_platform; SELECT username, password FROM users;'"
```

## 🔄 下一步行动

1. **重新生成密码哈希**: 使用正确的bcrypt哈希
2. **更新数据库**: 确保密码字段完整
3. **测试登录**: 验证所有用户账号
4. **检查前端**: 确保API调用正确

## 📞 技术支持

如果问题持续存在，请：
1. 检查网络连接
2. 确认服务器状态
3. 查看服务器日志
4. 联系系统管理员

---

**注意**: 这些是测试账号，生产环境中请使用更安全的密码！ 