# ğŸš¨ å®å¡”éƒ¨ç½²é—®é¢˜ä¿®å¤æŒ‡å— - 47.109.142.72

## ğŸ” é—®é¢˜åˆ†æ

æ ¹æ®é”™è¯¯æˆªå›¾ï¼Œå‡ºç°äº†ä»¥ä¸‹é—®é¢˜ï¼š

1. **MIMEç±»å‹é”™è¯¯**: `Expected a JavaScript module script but the server responded with a MIME type of 'application/octet-stream'`
2. **ç½‘ç«™æ ¹ç›®å½•é…ç½®é”™è¯¯**: å®å¡”é¢æ¿ä¸­æ ¹ç›®å½•è®¾ç½®ä¸º `/www/wwwroot/learning-platform/php-backend`
3. **å‰ç«¯æ–‡ä»¶æœªæ­£ç¡®éƒ¨ç½²**: é™æ€æ–‡ä»¶æ— æ³•æ­£ç¡®åŠ è½½

---

## ğŸ› ï¸ ç´§æ€¥ä¿®å¤æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šç«‹å³ä¿®å¤å®å¡”ç½‘ç«™é…ç½®

1. **ç™»å½•å®å¡”é¢æ¿**
2. **è¿›å…¥ç½‘ç«™ç®¡ç† â†’ ç‚¹å‡» 47.109.142.72 çš„"è®¾ç½®"**
3. **ä¿®æ”¹ç½‘ç«™æ ¹ç›®å½•**:
   ```
   é”™è¯¯é…ç½®: /www/wwwroot/learning-platform/php-backend
   æ­£ç¡®é…ç½®: /www/wwwroot/learning-platform
   ```

4. **é‡è¦**: ä¸è¦è®¾ç½®è¿è¡Œç›®å½•ï¼Œä¿æŒä¸º `/` 

### ç¬¬äºŒæ­¥ï¼šä¸Šä¼ å‰ç«¯æ„å»ºæ–‡ä»¶

1. **åˆ›å»ºæ­£ç¡®çš„ç›®å½•ç»“æ„**:
   ```bash
   # åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºç›®å½•
   mkdir -p /www/wwwroot/learning-platform/dist
   mkdir -p /www/wwwroot/learning-platform/php-backend
   ```

2. **ä¸Šä¼ æ–‡ä»¶**:
   - å°†æœ¬åœ°çš„ `dist/` ç›®å½•å†…å®¹ä¸Šä¼ åˆ°: `/www/wwwroot/learning-platform/dist/`
   - å°†æœ¬åœ°çš„ `php-backend/` ç›®å½•å†…å®¹ä¸Šä¼ åˆ°: `/www/wwwroot/learning-platform/php-backend/`

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ­£ç¡®çš„Nginxè§„åˆ™

**åœ¨å®å¡”é¢æ¿ â†’ ç½‘ç«™ â†’ 47.109.142.72 â†’ é…ç½®æ–‡ä»¶**ï¼Œæ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š

```nginx
server {
    listen 80;
    server_name 47.109.142.72;
    root /www/wwwroot/learning-platform;
    index index.html;

    # å®‰å…¨è®¾ç½®
    location ~ /\.(env|git) {
        deny all;
        return 404;
    }

    # å‰ç«¯Reactåº”ç”¨ - ä¸»è¦å¤„ç†
    location / {
        root /www/wwwroot/learning-platform/dist;
        try_files $uri $uri/ /index.html;
        
        # ä¿®å¤JavaScriptæ¨¡å—MIMEç±»å‹é—®é¢˜
        location ~* \.js$ {
            add_header Content-Type "text/javascript; charset=UTF-8";
            expires 7d;
            add_header Cache-Control "public";
        }
        
        location ~* \.mjs$ {
            add_header Content-Type "text/javascript; charset=UTF-8";
            expires 7d;
            add_header Cache-Control "public";
        }
        
        location ~* \.css$ {
            add_header Content-Type "text/css; charset=UTF-8";
            expires 7d;
            add_header Cache-Control "public";
        }
        
        location ~* \.(png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
            expires 30d;
            add_header Cache-Control "public";
        }
    }

    # PHP APIæ¥å£å¤„ç†
    location ^~ /api/ {
        # ç§»é™¤ /api å‰ç¼€ï¼Œè½¬å‘åˆ° PHP åç«¯
        rewrite ^/api/(.*)$ /php-backend/public/index.php/$1 last;
    }

    # PHPåç«¯å¤„ç†
    location ^~ /php-backend/ {
        alias /www/wwwroot/learning-platform/php-backend/;
        
        location ~ \.php$ {
            fastcgi_pass unix:/tmp/php-cgi-74.sock;  # æ ¹æ®PHPç‰ˆæœ¬è°ƒæ•´
            fastcgi_index index.php;
            include fastcgi_params;
            fastcgi_param SCRIPT_FILENAME $request_filename;
            fastcgi_param PATH_INFO $fastcgi_path_info;
            fastcgi_split_path_info ^(.+\.php)(/.+)$;
        }
    }

    # å¥åº·æ£€æŸ¥
    location = /health {
        rewrite ^/health$ /php-backend/public/index.php/health last;
    }

    # æ–‡ä»¶ä¸Šä¼ å¤„ç†
    location ^~ /uploads/ {
        alias /www/wwwroot/learning-platform/php-backend/uploads/;
        expires 30d;
        add_header Cache-Control "public";
    }

    # Gzipå‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript application/x-javascript;

    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;

    # æ—¥å¿—
    access_log /www/wwwlogs/learning-platform.access.log;
    error_log /www/wwwlogs/learning-platform.error.log;
}
```

### ç¬¬å››æ­¥ï¼šè®¾ç½®PHPåç«¯

1. **è¿›å…¥PHPåç«¯ç›®å½•**:
   ```bash
   cd /www/wwwroot/learning-platform/php-backend
   ```

2. **å®‰è£…ä¾èµ–** (å¦‚æœè¿˜æœªå®‰è£…):
   ```bash
   composer install --optimize-autoloader --no-dev
   ```

3. **è®¾ç½®æƒé™**:
   ```bash
   chmod -R 755 /www/wwwroot/learning-platform
   chmod -R 777 /www/wwwroot/learning-platform/php-backend/logs
   chmod -R 777 /www/wwwroot/learning-platform/php-backend/uploads
   chown -R www:www /www/wwwroot/learning-platform
   ```

4. **é…ç½®ç¯å¢ƒå˜é‡** (åˆ›å»º.envæ–‡ä»¶):
   ```bash
   cp .env.example .env
   # ç„¶åç¼–è¾‘.envæ–‡ä»¶è®¾ç½®æ•°æ®åº“è¿æ¥
   ```

### ç¬¬äº”æ­¥ï¼šåˆ›å»ºå’Œé…ç½®æ•°æ®åº“

1. **åœ¨å®å¡”é¢æ¿ â†’ æ•°æ®åº“ â†’ æ·»åŠ æ•°æ®åº“**:
   - æ•°æ®åº“å: `learning_platform`
   - ç”¨æˆ·å: `learning_platform`
   - å¯†ç : è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç 

2. **å¯¼å…¥æ•°æ®åº“**:
   - ä¸Šä¼  `server/init.sql` æ–‡ä»¶
   - åœ¨æ•°æ®åº“ç®¡ç†ä¸­å¯¼å…¥SQLæ–‡ä»¶

3. **æ›´æ–°.envé…ç½®**:
   ```env
   DB_HOST=localhost
   DB_DATABASE=learning_platform  
   DB_USERNAME=learning_platform
   DB_PASSWORD=ä½ è®¾ç½®çš„æ•°æ®åº“å¯†ç 
   ```

---

## âœ… éªŒè¯ä¿®å¤

### æµ‹è¯•å‰ç«¯
è®¿é—®: http://47.109.142.72
- âœ… åº”è¯¥èƒ½çœ‹åˆ°ç™»å½•é¡µé¢
- âœ… ä¸å†æœ‰JavaScript MIMEç±»å‹é”™è¯¯

### æµ‹è¯•åç«¯API
è®¿é—®: http://47.109.142.72/health
- âœ… åº”è¯¥è¿”å›å¥åº·çŠ¶æ€JSON

### æµ‹è¯•å®Œæ•´åŠŸèƒ½
è®¿é—®: http://47.109.142.72/php-backend/public/test-api.html
- âœ… å¯ä»¥è¿›è¡Œå®Œæ•´çš„APIæµ‹è¯•

---

## ğŸš¨ å¦‚æœä»æœ‰é—®é¢˜

### æ£€æŸ¥æ­¥éª¤ï¼š

1. **æŸ¥çœ‹é”™è¯¯æ—¥å¿—**:
   ```bash
   tail -f /www/wwwlogs/learning-platform.error.log
   ```

2. **æ£€æŸ¥PHPé”™è¯¯æ—¥å¿—**:
   ```bash  
   tail -f /www/wwwroot/learning-platform/php-backend/logs/app.log
   ```

3. **éªŒè¯æ–‡ä»¶æƒé™**:
   ```bash
   ls -la /www/wwwroot/learning-platform/
   ls -la /www/wwwroot/learning-platform/dist/
   ls -la /www/wwwroot/learning-platform/php-backend/
   ```

4. **æµ‹è¯•Nginxé…ç½®**:
   ```bash
   nginx -t
   systemctl reload nginx
   ```

---

## ğŸ“ æ­£ç¡®çš„ç›®å½•ç»“æ„

ä¿®å¤åçš„æœåŠ¡å™¨ç›®å½•ç»“æ„åº”è¯¥æ˜¯ï¼š
```
/www/wwwroot/learning-platform/
â”œâ”€â”€ dist/                       # å‰ç«¯æ„å»ºæ–‡ä»¶ï¼ˆReactåº”ç”¨ï¼‰
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ index-xxx.js       # ä¸»è¦JSæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ index-xxx.css      # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ ...
â”œâ”€â”€ php-backend/                # PHPåç«¯
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ index.php          # PHPå…¥å£
â”‚   â”‚   â””â”€â”€ test-api.html      # APIæµ‹è¯•é¡µ
â”‚   â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ .env                   # ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ ...
```

---

## ğŸ¯ é»˜è®¤ç™»å½•è´¦æˆ·

ä¿®å¤å®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸‹è´¦æˆ·æµ‹è¯•ï¼š

| ç”¨æˆ·å | å¯†ç  | è§’è‰² |
|--------|------|------|
| admin | admin123456 | ç®¡ç†å‘˜ |
| demo | demo123456 | æ™®é€šç”¨æˆ· |
| maintenance | maintenance123456 | ç»´æŠ¤ç”¨æˆ· |

âš ï¸ **æˆåŠŸç™»å½•åè¯·ç«‹å³ä¿®æ”¹è¿™äº›é»˜è®¤å¯†ç ï¼**
