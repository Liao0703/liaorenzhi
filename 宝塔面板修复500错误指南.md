# ğŸ”§ é€šè¿‡å®å¡”é¢æ¿ä¿®å¤500é”™è¯¯æŒ‡å—

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### 1. è®¿é—®å®å¡”é¢æ¿
- åœ°å€ï¼šhttp://47.109.142.72:8888
- éœ€è¦å®å¡”é¢æ¿çš„ç”¨æˆ·åå’Œå¯†ç 

> **æ³¨æ„**ï¼šå¦‚æœæ²¡æœ‰å®å¡”é¢æ¿å¯†ç ï¼Œå¯ä»¥é€šè¿‡SSHç™»å½•æœåŠ¡å™¨åæ‰§è¡Œ `bt default` æŸ¥çœ‹é»˜è®¤ä¿¡æ¯

## ğŸš€ ä¿®å¤æ­¥éª¤

### æ­¥éª¤1ï¼šç™»å½•å®å¡”é¢æ¿åçš„æ“ä½œ

#### 1.1 ä½¿ç”¨ç»ˆç«¯åŠŸèƒ½
1. åœ¨å·¦ä¾§èœå•æ‰¾åˆ° **"ç»ˆç«¯"**
2. ç‚¹å‡»è¿›å…¥Webç»ˆç«¯
3. æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/learning-platform

# åœæ­¢æ‰€æœ‰Nodeè¿›ç¨‹
pm2 stop all
pm2 delete all

# å¼ºåˆ¶åœæ­¢ç«¯å£è¿›ç¨‹
lsof -ti:3002 | xargs kill -9 2>/dev/null || true
lsof -ti:3000 | xargs kill -9 2>/dev/null || true

# é‡å¯æœåŠ¡
NODE_ENV=production pm2 start server.cjs --name "learning-platform" --instances 1
pm2 save

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status
```

#### 1.2 ä½¿ç”¨æ–‡ä»¶ç®¡ç†å™¨
1. ç‚¹å‡»å·¦ä¾§èœå• **"æ–‡ä»¶"**
2. å¯¼èˆªåˆ°ï¼š`/www/wwwroot/learning-platform`
3. æ£€æŸ¥ä»¥ä¸‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š
   - âœ… `server.cjs`
   - âœ… `env.cloud`
   - âœ… `node_modules/` æ–‡ä»¶å¤¹
   - âœ… `dist/` æ–‡ä»¶å¤¹

### æ­¥éª¤2ï¼šé€šè¿‡ç½‘ç«™ç®¡ç†ä¿®å¤

#### 2.1 æ£€æŸ¥ç½‘ç«™é…ç½®
1. ç‚¹å‡»å·¦ä¾§èœå• **"ç½‘ç«™"**
2. æ‰¾åˆ°ä½ çš„ç«™ç‚¹ï¼ˆåŸŸåå¯èƒ½æ˜¯ 47.109.142.72ï¼‰
3. ç‚¹å‡» **"è®¾ç½®"**

#### 2.2 æ£€æŸ¥Nodeé¡¹ç›®è®¾ç½®
1. åœ¨ç½‘ç«™è®¾ç½®ä¸­æ‰¾åˆ° **"Nodeé¡¹ç›®"** é€‰é¡¹
2. æ£€æŸ¥é…ç½®ï¼š
   - é¡¹ç›®è·¯å¾„ï¼š`/www/wwwroot/learning-platform`
   - å¯åŠ¨æ–‡ä»¶ï¼š`server.cjs`
   - ç«¯å£ï¼š`3002`
   - å¯åŠ¨å‚æ•°ï¼š`NODE_ENV=production`

#### 2.3 é‡å¯Nodeé¡¹ç›®
1. åœ¨Nodeé¡¹ç›®è®¾ç½®ä¸­ç‚¹å‡» **"åœæ­¢"**
2. ç­‰å¾…å‡ ç§’åç‚¹å‡» **"å¯åŠ¨"**
3. æŸ¥çœ‹å¯åŠ¨æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯

### æ­¥éª¤3ï¼šæ£€æŸ¥å’Œä¿®å¤Nginxé…ç½®

#### 3.1 æŸ¥çœ‹Nginxé…ç½®
1. åœ¨ç½‘ç«™è®¾ç½®ä¸­æ‰¾åˆ° **"é…ç½®æ–‡ä»¶"**
2. ç¡®ä¿åŒ…å«ä»¥ä¸‹å…³é”®é…ç½®ï¼š

```nginx
server {
    listen 80;
    server_name 47.109.142.72;
    root /www/wwwroot/learning-platform/dist;
    index index.html;

    # APIä»£ç†
    location /api/ {
        proxy_pass http://127.0.0.1:3002/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # å‰ç«¯è·¯ç”±
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

#### 3.2 é‡è½½Nginx
1. åœ¨å®å¡”é¢æ¿é¦–é¡µæ‰¾åˆ° **"Nginx"**
2. ç‚¹å‡» **"é‡è½½é…ç½®"**

### æ­¥éª¤4ï¼šæŸ¥çœ‹æ—¥å¿—è¯Šæ–­é—®é¢˜

#### 4.1 æŸ¥çœ‹PM2æ—¥å¿—
åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œï¼š
```bash
pm2 logs learning-platform --lines 50
```

#### 4.2 æŸ¥çœ‹é”™è¯¯æ—¥å¿—
1. åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­å¯¼èˆªåˆ°ï¼š`/www/wwwlogs/`
2. æŸ¥çœ‹ä»¥ä¸‹æ—¥å¿—æ–‡ä»¶ï¼š
   - `learning-platform-pm2.log`
   - `learning-platform-error.log`
   - `47.109.142.72.error.log`

## ğŸ› ï¸ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šç«¯å£è¢«å ç”¨
```bash
# åœ¨ç»ˆç«¯æ‰§è¡Œ
lsof -ti:3002 | xargs kill -9
```

### é—®é¢˜2ï¼šæƒé™é—®é¢˜
```bash
# ä¿®å¤æ–‡ä»¶æƒé™
chown -R www:www /www/wwwroot/learning-platform
chmod -R 755 /www/wwwroot/learning-platform
```

### é—®é¢˜3ï¼šä¾èµ–ç¼ºå¤±
```bash
cd /www/wwwroot/learning-platform
npm install --production
```

## âœ… éªŒè¯ä¿®å¤ç»“æœ

### 1. åœ¨å®å¡”ç»ˆç«¯æµ‹è¯•
```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://127.0.0.1:3002/health

# æµ‹è¯•APIçŠ¶æ€
curl http://127.0.0.1:3002/api/status
```

### 2. æµè§ˆå™¨è®¿é—®æµ‹è¯•
- è®¿é—®ï¼šhttp://47.109.142.72
- åº”è¯¥çœ‹åˆ°ç™»å½•é¡µé¢è€Œä¸æ˜¯500é”™è¯¯

## ğŸ†˜ å¦‚æœè¿˜æ˜¯æ— æ³•è§£å†³

### è·å–å®å¡”é¢æ¿å¯†ç 
å¦‚æœå¿˜è®°å®å¡”é¢æ¿å¯†ç ï¼Œéœ€è¦SSHç™»å½•æœåŠ¡å™¨åæ‰§è¡Œï¼š
```bash
# æŸ¥çœ‹é¢æ¿å…¥å£ä¿¡æ¯
bt default

# é‡ç½®é¢æ¿å¯†ç 
bt 5
```

### å¤‡é€‰æ–¹æ¡ˆ
1. ä½¿ç”¨å®å¡”çš„ **"è®¡åˆ’ä»»åŠ¡"** åŠŸèƒ½åˆ›å»ºè„šæœ¬ä»»åŠ¡
2. è”ç³»æœ‰æœåŠ¡å™¨SSHæƒé™çš„ç®¡ç†å‘˜
3. é€šè¿‡äº‘æœåŠ¡å•†çš„æ§åˆ¶å°é‡ç½®æœåŠ¡å™¨å¯†ç 

---

**æç¤º**ï¼šå®å¡”é¢æ¿çš„å…·ä½“ç•Œé¢å¯èƒ½å› ç‰ˆæœ¬ä¸åŒç•¥æœ‰å·®å¼‚ï¼Œä½†åŸºæœ¬åŠŸèƒ½ä½ç½®ç›¸ä¼¼ã€‚


