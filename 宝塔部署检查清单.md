# å®å¡”éƒ¨ç½²æ£€æŸ¥æ¸…å• - 47.109.142.72

## ğŸš¨ å½“å‰é—®é¢˜
- æ— æ³•è®¿é—®ç½‘é¡µï¼šhttp://47.109.142.72
- JavaScript MIMEç±»å‹é”™è¯¯
- é¡µé¢ç©ºç™½æˆ–åŠ è½½å¤±è´¥

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

### 1. æœåŠ¡å™¨åŸºç¡€æ£€æŸ¥
- [ ] æœåŠ¡å™¨å¯ä»¥æ­£å¸¸SSHè¿æ¥
- [ ] å®å¡”é¢æ¿å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] Node.jså·²å®‰è£…ï¼ˆæ¨èç‰ˆæœ¬ï¼š18.xæˆ–20.xï¼‰
- [ ] PM2å·²å®‰è£…

### 2. é¡¹ç›®æ–‡ä»¶æ£€æŸ¥
- [ ] é¡¹ç›®å·²ä¸Šä¼ åˆ°ï¼š`/www/wwwroot/learning-platform`
- [ ] `dist`ç›®å½•å­˜åœ¨ä¸”åŒ…å«å‰ç«¯æ–‡ä»¶
- [ ] `server-baota.js`æ–‡ä»¶å­˜åœ¨
- [ ] `package.json`æ–‡ä»¶å­˜åœ¨

### 3. å®å¡”é¢æ¿é…ç½®
- [ ] å·²åˆ›å»ºç½‘ç«™ï¼šåŸŸåä¸º `47.109.142.72`
- [ ] ç½‘ç«™æ ¹ç›®å½•è®¾ç½®ä¸ºï¼š`/www/wwwroot/learning-platform/dist`
- [ ] PHPç‰ˆæœ¬è®¾ç½®ä¸º"çº¯é™æ€"æˆ–å…³é—­PHP
- [ ] SSLè¯ä¹¦çŠ¶æ€ï¼ˆå¯é€‰ï¼‰

### 4. Nginxé…ç½®æ£€æŸ¥
- [ ] å¤åˆ¶äº†æ­£ç¡®çš„Nginxé…ç½®
- [ ] server_nameè®¾ç½®ä¸º `47.109.142.72`
- [ ] é™æ€æ–‡ä»¶è·¯å¾„æ­£ç¡®
- [ ] APIä»£ç†é…ç½®æ­£ç¡®ï¼ˆç«¯å£3001ï¼‰

### 5. åç«¯æœåŠ¡æ£€æŸ¥
- [ ] åç«¯æœåŠ¡å·²å¯åŠ¨ï¼š`pm2 start server-baota.js`
- [ ] PM2çŠ¶æ€æ­£å¸¸ï¼š`pm2 status`
- [ ] ç«¯å£3001æœªè¢«å ç”¨
- [ ] å¥åº·æ£€æŸ¥æ­£å¸¸ï¼š`curl http://localhost:3001/health`

### 6. é˜²ç«å¢™å’Œç«¯å£
- [ ] ç«¯å£80å·²å¼€æ”¾ï¼ˆHTTPï¼‰
- [ ] ç«¯å£443å·²å¼€æ”¾ï¼ˆHTTPSï¼Œå¦‚æœä½¿ç”¨SSLï¼‰
- [ ] ç«¯å£3001å·²å¼€æ”¾ï¼ˆåç«¯APIï¼‰
- [ ] å®å¡”å®‰å…¨ç»„è§„åˆ™æ­£ç¡®

### 7. æ–‡ä»¶æƒé™
- [ ] é¡¹ç›®ç›®å½•æƒé™ï¼š`chmod -R 755 /www/wwwroot/learning-platform`
- [ ] Nginxç”¨æˆ·æœ‰è¯»å–æƒé™
- [ ] æ—¥å¿—ç›®å½•å¯å†™

## ğŸ”§ å¿«é€Ÿä¿®å¤å‘½ä»¤

### åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/learning-platform

# 2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la
ls -la dist/

# 3. è®¾ç½®æ­£ç¡®æƒé™
chmod -R 755 .
chown -R www:www .

# 4. åœæ­¢æ—§æœåŠ¡
pm2 stop all
pm2 delete all

# 5. å¯åŠ¨æ–°æœåŠ¡
pm2 start server-baota.js --name learning-platform
pm2 save
pm2 startup

# 6. æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status
pm2 logs learning-platform

# 7. æµ‹è¯•åç«¯API
curl http://localhost:3001/health
curl http://localhost:3001/api/status

# 8. æµ‹è¯•å‰ç«¯è®¿é—®
curl -I http://47.109.142.72
```

## ğŸ“‹ Nginxé…ç½®æ¨¡æ¿

```nginx
server {
    listen 80;
    server_name 47.109.142.72;
    root /www/wwwroot/learning-platform/dist;
    index index.html;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        try_files $uri $uri/ /index.html;
        
        # ä¿®å¤JavaScript MIMEç±»å‹
        location ~* \.js$ {
            add_header Content-Type "application/javascript; charset=UTF-8";
            add_header X-Content-Type-Options "nosniff";
            expires 1d;
        }
        
        location ~* \.css$ {
            add_header Content-Type "text/css; charset=UTF-8";
            expires 1d;
        }
    }

    # APIä»£ç†åˆ°åç«¯
    location /api/ {
        proxy_pass http://127.0.0.1:3001/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # å¥åº·æ£€æŸ¥
    location /health {
        proxy_pass http://127.0.0.1:3001/health;
    }

    # faviconå¤„ç†
    location /favicon.ico {
        return 204;
        access_log off;
    }

    # æ—¥å¿—
    access_log /www/wwwlogs/learning-platform.access.log;
    error_log /www/wwwlogs/learning-platform.error.log;
}
```

## ğŸ” æ•…éšœæ’æŸ¥

### 1. é¡µé¢æ— æ³•è®¿é—®
```bash
# æ£€æŸ¥NginxçŠ¶æ€
systemctl status nginx
nginx -t

# æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tlnp | grep :80
```

### 2. JavaScripté”™è¯¯
```bash
# æ£€æŸ¥æ–‡ä»¶MIMEç±»å‹
curl -I http://47.109.142.72/assets/index-xxx.js
```

### 3. APIæ— æ³•è®¿é—®
```bash
# æ£€æŸ¥åç«¯æœåŠ¡
pm2 logs learning-platform
curl http://localhost:3001/health
```

### 4. æƒé™é—®é¢˜
```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /www/wwwroot/learning-platform/dist/
```

## ğŸ“ å¸¸è§é—®é¢˜è§£å†³

### Q: é¡µé¢ç©ºç™½
A: æ£€æŸ¥distç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œindex.htmlæ˜¯å¦æ­£ç¡®

### Q: JavaScript MIMEé”™è¯¯
A: ç¡®ä¿Nginxé…ç½®ä¸­åŒ…å«äº†æ­£ç¡®çš„MIMEç±»å‹è®¾ç½®

### Q: APIè¯·æ±‚å¤±è´¥
A: æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼Œç«¯å£æ˜¯å¦æ­£ç¡®

### Q: 403 Forbidden
A: æ£€æŸ¥æ–‡ä»¶æƒé™å’ŒNginxé…ç½®

## âœ… éƒ¨ç½²æˆåŠŸæ ‡å¿—

éƒ¨ç½²æˆåŠŸåï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿï¼š
1. âœ… è®¿é—® http://47.109.142.72 çœ‹åˆ°ç™»å½•é¡µé¢
2. âœ… æ²¡æœ‰JavaScript MIMEç±»å‹é”™è¯¯
3. âœ… APIæ¥å£æ­£å¸¸å“åº”
4. âœ… å¯ä»¥æ­£å¸¸ç™»å½•å’Œä½¿ç”¨åŠŸèƒ½

## ğŸ“± è”ç³»æ”¯æŒ

å¦‚æœé—®é¢˜ä»æœªè§£å†³ï¼Œè¯·æä¾›ï¼š
1. å®å¡”é¢æ¿æˆªå›¾
2. PM2çŠ¶æ€ï¼š`pm2 status`
3. Nginxé”™è¯¯æ—¥å¿—ï¼š`tail -f /www/wwwlogs/learning-platform.error.log`
4. åç«¯æ—¥å¿—ï¼š`pm2 logs learning-platform`




